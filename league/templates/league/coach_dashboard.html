<!-- prettier-ignore -->
{% extends 'league/base.html' %} {% block content %}
{% load league_tags %}
<div class="container">
  <h2>Coach Dashboard</h2>

  {% if divisions %}
  <h4>Your Divisions</h4>
  <ul class="list-group mb-4">
    {% for division in divisions %}
    <li
      class="list-group-item d-flex justify-content-between align-items-center"
    >
      <span>{{ division.name }}</span>
      <a
        href="{% url 'dashboard_with_division' division.id %}"
        class="btn btn-sm btn-primary"
        >View Division</a
      >
    </li>
    {% endfor %}
  </ul>
  {% endif %}
  <!-- prettier-ignore -->
  {% if teams %}
  <h4>Your Teams</h4>
  {% for team in teams %}
  <div class="card my-4">
    <div class="card-header">
      <strong>{{ team.name }}</strong> ({{ team.division.name }})
      <a
        href="{% url 'team_logs' team.id %}"
        class="btn btn-sm btn-outline-primary ms-4"
        >View Team Logs</a
      >
    </div>

    <div class="card-body">
      <h5>Players:</h5>
      <ul>
        {% for player in team.players.all %}
        <li>
          <a href="{% url 'coach_player_detail' player.id %}">
            {{ player.first_name }} {{ player.last_name }}
          </a>
        </li>
        {% endfor %}
      </ul>
    </div>


    <h5 class="mt-4">ðŸ“… Game History</h5>
    <div
      class="p-2 rounded"
      style="background-color: #fff9e6; border: 1px solid #000"
    >
      {% with games=games_by_team|get_item:team.id %}
        {% if games %}
          <table class="table table-bordered table-sm bg-white">
            <thead>
              <tr>
                <th>Date</th>
                <th>Opponent</th>
                <th>Location</th>
                <th>Box Score</th>
              </tr>
            </thead>
            <tbody>
              {% for game in games %}
                <tr>
                  <td>{{ game.date|date:"Y-m-d" }}</td>
                  <td>
                    {% if game.team_home == team %}
                      {{ game.team_away.name }}
                    {% else %}
                      {{ game.team_home.name }}
                    {% endif %}
                  </td>
                  <td>{{ game.location }}</td>
                  <td>
                    <a href="{% url 'box_score' game.id %}">View</a>
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="text-muted">No games recorded for this team.</p>
        {% endif %}
      {% endwith %}
    </div>
    

    
  </div>
  {% endfor %} {% else %}
  <p>You are not assigned to any teams yet.</p>
  {% endif %}
</div>
{% endblock %}
